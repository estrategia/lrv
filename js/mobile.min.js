function alerta(a){$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+a+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})}function iniciarTour(){tour.start()}function cerrarTour(){tour&&tour.complete()}function noMostrarMas(){Cookies.set("mobileTour","noMostrar",{expires:365}),cerrarTour()}function volverAMostrar(){return Cookies.get("mobileTour")}function iniciarTourAutomatico(){"noMostrar"!=volverAMostrar()&&iniciarTour()}function animarRelacionado(){$("html, body").animate({scrollTop:0},600),$("#link-relacionados-agregar").css("opacity",""),intervalRelacionados=setInterval(function(){$("#link-relacionados-agregar").animate({opacity:"0.5"},400,function(){$("#link-relacionados-agregar").animate({opacity:"1"},400)})},1e3),$("#link-relacionados-agregar").css("display",""),setTimeout(function(){null!=intervalRelacionados&&(clearInterval(intervalRelacionados),intervalRelacionados=null),$("#link-relacionados-agregar").css("opacity","")},1e4)}function quitarRelacionado(){null!=intervalRelacionados&&(clearInterval(intervalRelacionados),intervalRelacionados=null),$("#link-relacionados-agregar").css("display","none"),$("#link-relacionados-agregar").css("opacity",""),$("#link-relacionados-agregar").attr("href","#")}function ubicacionGPS(){navigator.geolocation?($.mobile.loading("show"),navigator.geolocation.getCurrentPosition(obtenerPosicion,errorPosicion,{enableHighAccuracy:!0,timeout:3e4,maximumAge:0})):alert("Servicio no soportado por este navegador.")}function obtenerPosicion(a){var b=0,c=0;a&&(b=a.coords.latitude,c=a.coords.longitude),$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/sitio/gps",data:{lat:b,lon:c},beforeSend:function(){$("#popup-ubicacion-gps").remove()},success:function(a){"ok"==a.result?($("#ubicacion-seleccion-ciudad").val(a.response.ciudad).attr("data-ciudad"),$("#ubicacion-seleccion-sector").val(a.response.sector).attr("data-sector"),$("#ubicacion-seleccion-direccion").val(""),ubicacionSeleccion()):a.responseModal?$("<div>").mdialog({content:a.responseModal}):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+a.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"}),$.mobile.loading("hide")},error:function(a,b,c){$.mobile.loading("hide"),alert("Error: "+c)}})}function ubicacionSeleccion(){var a=$("#form-ubicacion");$.ajax({type:"POST",async:!0,url:requestUrl+"/sitio/ubicacionSeleccion",data:a.serialize(),dataType:"json",beforeSend:function(){$.mobile.loading("show")},complete:function(a){$.mobile.loading("hide")},success:function(a){"ok"==a.result?(dialogoAnimado(a.response),a.urlAnterior?location.href=a.urlAnterior:location.href=requestUrl+"/sitio/inicio"):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+a.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})},error:function(a,b,c){$.mobile.loading("hide"),alert(c)}})}function errorPosicion(a){$.mobile.loading("hide");var b="NA";switch(a.code){case a.PERMISSION_DENIED:b="Por favor activar/habilitar servicio de ubicación de tu dispositivo.";break;case a.POSITION_UNAVAILABLE:b="Posición no disponible.";break;case a.TIMEOUT:b="Expiró el tiempo de espera.";break;case a.UNKNOWN_ERROR:b="Error desconocido: "+a.message}alert(b)}function subtotalUnidadProducto(a){var b=$("#cantidad-producto-unidad-"+a).val();b=parseInt(b),isNaN(b)&&(b=1),b<=1&&(b=1),$("#cantidad-producto-unidad-"+a).val(b),$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/catalogo/subtotalUnidad",data:{codigo:a,cantidad:b},beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(b){"ok"==b.result?$("#subtotal-producto-unidad-"+a).html(b.response.valorFormato):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+b.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})},error:function(a,b,c){alert("Error: "+c)}})}function subtotalParcialProductoFraccion(a,b,c){var d=parseInt($("#cantidad-producto-fraccion-"+a).val());isNaN(d)&&(d=0),d<0&&(d=0),$("#cantidad-producto-fraccion-"+a).val(d);var e=Math.floor(b/c),f=$("#cantidad-producto-unidad-"+a).val();if(f=parseInt(f),isNaN(f)&&(f=0),f<0&&(f=0),d>=e){var g=Math.floor(d/e),h=d%e;f+=g,d=h}$("#cantidad-producto-unidad-"+a).val(f),$("#cantidad-producto-fraccion-"+a).val(d),$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/catalogo/subtotalFraccion",data:{codigo:a,cantidadUnidad:f,cantidadFraccion:d},beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(b){"ok"==b.result?($("#subtotal-producto-unidad-"+a).html(b.response.valorUnidadFormato),$("#subtotal-producto-fraccion-"+a).html(b.response.valorFraccionFormato),$("#total-producto-"+a).html(b.response.valorTotalFormato)):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+b.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})},error:function(a,b,c){alert("Error: "+c)}})}function subtotalProductoBodega(a){var b=parseInt($("#cantidad-producto-ubicacion-"+a).val());isNaN(b)&&(b=0),b<0&&(b=0);var c=$("#cantidad-producto-bodega-"+a).val();c=parseInt(c),isNaN(c)&&(c=0),c<0&&(c=0),$("#cantidad-producto-ubicacion-"+a).val(b),$("#cantidad-producto-bodega-"+a).val(c),$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/catalogo/subtotalBodega",data:{codigo:a,bodega:c,ubicacion:b},beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(b){"ok"==b.result?($("#subtotal-producto-bodega-"+a).html(b.response.valorBodegaFormato),$("#subtotal-producto-ubicacion-"+a).html(b.response.valorUbicacionFormato),$("#total-producto-"+a).html(b.response.valorTotalFormato)):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+b.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})},error:function(a,b,c){alert("Error: "+c)}})}function subtotalCombo(a){var b=$("#cantidad-combo-"+a).val();b=parseInt(b),isNaN(b)&&(b=1),b<=1&&(b=1),$("#cantidad-combo-"+a).val(b),$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/catalogo/subtotalCombo",data:{codigo:a,cantidad:b},beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(b){"ok"==b.result?$("#subtotal-combo-"+a).html(b.response.valorFormato):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+b.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})},error:function(a,b,c){alert("Error: "+c)}})}function subtotalProductoCarro(a){var b=$("#cantidad-producto-"+a).val();b=parseInt(b),isNaN(b)&&(b=1),b<=1&&(b=1),$("#cantidad-producto-"+a).val(b),$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/carro/modificar",data:{id:a,cantidad:b},beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){"ok"==a.result?($("#div-carro").html(a.carro),$("#div-carro").trigger("create"),$("#panel-carro-canasta").html(a.canasta),$("#panel-carro-canasta").trigger("create")):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+a.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})},error:function(a,b,c){alert("Error: "+c)}})}function ratyclic(a,b){alert("ID ratyclik: "+this.id+"\nscore: "+a+"\nevent: "+b.type)}function recalcularFiltros(a){var b={};$("input[id^='FiltroForm_listMarcas_']").each(function(){$(this).is(":checked")&&(b[$(this).val()]=parseInt($(this).val()))});var c={};$("input[id^='FiltroForm_listFiltros_']").each(function(){$(this).is(":checked")&&(c[$(this).val()]=parseInt($(this).attr("data-filtro")))}),$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/catalogo/filtro",data:{marcas:b,atributos:c,tipo:a},beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){a.hasOwnProperty("marcas")&&($("#div-filtro-marcas").html(a.marcas),$("#div-filtro-marcas").trigger("create")),a.hasOwnProperty("atributos")&&($("#div-filtro-atributos").html(a.atributos),$("#div-filtro-atributos").trigger("create"))},error:function(a,b,c){alert("Error: "+c)}})}function verUbicacion(){"0"==$("#ubicacion-info").attr("data-active")?($("#ubicacion-info").removeClass("hide"),$("#ubicacion-info").addClass("display"),$("#ubicacion-info").attr("data-active","1")):($("#ubicacion-info").removeClass("display"),$("#ubicacion-info").addClass("hide"),$("#ubicacion-info").attr("data-active","0"))}function pasoTipoEntrega(a,b,c){var d={siguiente:b,"FormaPagoForm[indicePuntoVenta]":$('input[name="FormaPagoForm[indicePuntoVenta]"]').val(),"FormaPagoForm[tipoEntrega]":$('input[name="FormaPagoForm[tipoEntrega]"]').val()};$.ajax({type:"POST",async:!0,url:requestUrl+"/carro/pagar/paso/"+a+"/post/true",data:$.param(d),beforeSend:function(){c.button("disable"),$('div[id^="FormaPagoForm_"].has-error').html(""),$('div[id^="FormaPagoForm_"].has-error').css("display","none"),$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){var b=$.parseJSON(a);"ok"===b.result?window.location.replace(b.redirect):"error"===b.result?(alerta(b.response),c.button("enable")):($.each(b,function(a,b){$("#"+a+"_em_").html(b),$("#"+a+"_em_").css("display","block")}),c.button("enable"))},error:function(a,b,d){alert("Error: "+d),c.button("enable")}})}function pasoDespacho(a,b,c){var d={siguiente:b,direccion:$('input[name="FormaPagoForm[idDireccionDespacho]"]:checked').val()};$.ajax({type:"POST",async:!0,url:requestUrl+"/carro/pagar/paso/"+a+"/post/true",data:$.param(d)+"&"+$("#form-direccion-pagoinvitado").serialize(),beforeSend:function(){c.button("disable"),$('div[id^="FormaPagoForm_"].has-error').html(""),$('div[id^="FormaPagoForm_"].has-error').css("display","none"),$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){var b=$.parseJSON(a);"ok"===b.result?window.location.replace(b.redirect):"error"===b.result?(alerta(b.response),c.button("enable")):($.each(b,function(a,b){$("#"+a+"_em_").html(b),$("#"+a+"_em_").css("display","block")}),c.button("enable"))},error:function(a,b,d){alert("Error: "+d),c.button("enable")}})}function pasoEntrega(a,b,c){var d={siguiente:b};$.ajax({type:"POST",async:!0,url:requestUrl+"/carro/pagar/paso/"+a+"/post/true",data:$.param(d)+"&"+$("#form-pago-entrega").serialize(),beforeSend:function(){c.button("disable"),$('div[id^="FormaPagoForm_"].has-error').html(""),$('div[id^="FormaPagoForm_"].has-error').css("display","none"),$("#form-pago-entrega").trigger("create"),$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){var b=$.parseJSON(a);"ok"===b.result?window.location.replace(b.redirect):"error"===b.result?(alerta(b.response),c.button("enable")):($.each(b,function(a,b){$("#"+a+"_em_").html(b),$("#"+a+"_em_").css("display","block")}),c.button("enable"))},error:function(a,b,d){alert("Error: "+d),c.button("enable")}})}function pasoPago(a,b,c){var d={siguiente:b};$.ajax({type:"POST",async:!0,url:requestUrl+"/carro/pagar/paso/"+a+"/post/true",data:$.param(d)+"&"+$("#form-pago-pago").serialize(),beforeSend:function(){c.button("disable"),$('div[id^="FormaPagoForm_"].has-error').html(""),$('div[id^="FormaPagoForm_"].has-error').css("display","none"),$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){var b=$.parseJSON(a);"ok"===b.result?window.location.replace(b.redirect):"error"===b.result?(alerta(b.response),c.button("enable")):($.each(b,function(a,b){$("#"+a+"_em_").html(b),$("#"+a+"_em_").css("display","block")}),c.button("enable"))},error:function(a,b,d){alert("Error: "+d),c.button("enable")}})}function pasoConfirmacion(a,b,c){var d={siguiente:b};$.ajax({type:"POST",async:!0,url:requestUrl+"/carro/pagar/paso/"+a+"/post/true",data:$.param(d)+"&"+$("#form-pago-confirmacion").serialize(),beforeSend:function(){c.button("disable"),$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){var b=$.parseJSON(a);"ok"===b.result?window.location.replace(b.redirect):"error"===b.result?(alerta(b.response),c.button("enable")):($.each(b,function(a,b){$("#"+a+"_em_").html(b),$("#"+a+"_em_").css("display","block")}),c.button("enable"))},error:function(a,b,d){alert("Error: "+d),c.button("enable")}})}function pagoCredirebaja(a,b){if($(a).length){var c=$('input[name="'+b+'[idFormaPago]"]:checked').val();void 0==c||0==$("#"+b+"_idFormaPago_"+c).attr("data-credirebaja")?($('[id="div-credirebaja"] input').attr("disabled","disabled"),$('[id="div-credirebaja"] select').attr("disabled","disabled"),$("#div-credirebaja").css("display","none")):($('[id="div-credirebaja"] input').removeAttr("disabled"),$('[id="div-credirebaja"] select').removeAttr("disabled"),$("#div-credirebaja").css("display","block"))}}function colapseDireccion(){if($("#form-pagoexpess").length){var a=$('input[name="PagoExpress[idDireccionDespacho]"]:checked').val();$("div[id^=div-infodireccion-]").css("display","none"),void 0!==a&&$("#div-infodireccion-"+a).css("display","block")}}function seleccionTipoEntrega(a,b){$('div[data-role="tipoentrega"]').removeClass("activo"),$('div[data-role="tipoentrega"]div[data-tipo="'+a+'"]').addClass("activo"),$('div[data-role="tipoentrega"]').addClass("inactivo"),$('div[data-role="tipoentrega"]div[data-tipo="'+a+'"]').removeClass("inactivo"),$("#FormaPagoForm_tipoEntrega").val(a),$('input[name="FormaPagoForm[indicePuntoVenta]"]').val("")}function visualizarFormulaMedica(){$("#FormaPagoForm_confirmacion").prop("checked")?$("#form-formula-medica").removeClass("display-none"):$("#form-formula-medica").addClass("display-none")}function guardarMascota(){$.ajax({type:"POST",url:requestUrl+"/campania/guardarDatosMascota/",data:$("#formulario-mascota").serialize(),dataType:"json",beforeSend:function(){$(".error").html(""),$.mobile.loading("show")},complete:function(a){$.mobile.loading("hide")},success:function(a){"ok"===a.result?($("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>Datos registrados<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"}),document.getElementById("formulario-mascota").reset()):$.each(a,function(a,b){$("#"+a+"_em").html(b),$("#"+a+"_em").css("display","block")})}})}intervalRelacionados=null;var tour;tour=new Shepherd.Tour({defaults:{classes:"shepherd-theme-default",scrollTo:!0}}),tour.addStep("arrastra-mapa",{text:"Arrastra el mapa y ubica el marcador en el lugar donde te encuentras.",attachTo:"#tour-origen bottom",when:{show:function(){resizingMap(),locationMarker.setPosition(map.getCenter())}},buttons:[{text:"Enterado",action:function(){noMostrarMas()}},{text:"Siguiente",action:tour.next}]}),tour.addStep("confirma-ubicacion",{text:"Para finalizar presiona el boton confirmar.",attachTo:"#confirma-ubicacion top",buttons:[{text:"Enterado",action:function(){noMostrarMas()}},{text:"Cerrar",action:tour.next}]}),$(document).on("click",'a[data-role="ubicacion-seleccion-mapa"]',function(){var a=0,b=0;map&&(a=map.getCenter().lat(),b=map.getCenter().lng()),$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/sitio/gps",data:{lat:a,lon:b},beforeSend:function(){$.mobile.loading("show")},success:function(a){"ok"==a.result?($("#ubicacion-seleccion-ciudad").val(a.response.ciudad),$("#ubicacion-seleccion-sector").val(a.response.sector),$("#ubicacion-seleccion-direccion").val(""),ubicacionSeleccion()):a.responseModal?$("<div>").mdialog({content:a.responseModal}):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+a.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"}),$.mobile.loading("hide")},error:function(a,b,c){$.mobile.loading("hide"),alert(c)}})}),$(document).on("click",'button[data-role="seleccion-barrio"]',function(){return $("#page-ubicacion-barrio").length>0?($("#ubicacion-barrios-respuesta").html(""),$.mobile.changePage("#page-ubicacion-barrio",{transition:"pop",role:"dialog",reverse:!1})):$.ajax({type:"GET",async:!0,url:requestUrl+"/sitio/seleccionBarrio",dataType:"html",beforeSend:function(){$.mobile.loading("show")},complete:function(a){$.mobile.loading("hide")},success:function(a){$("body").append(a),$.mobile.changePage("#page-ubicacion-barrio",{transition:"pop",role:"dialog",reverse:!1})},error:function(a,b,c){$.mobile.loading("hide"),alert("Error: "+c)}}),!1}),$(document).on("click",'button[data-role="ubicacion-barrio"]',function(){var a=$("#selector-ciudad").val(),b=$("input[name='barrio']").val();return $.ajax({type:"post",async:!0,url:requestUrl+"/sitio/ubicacionBarrio",data:{ciudad:a,barrio:b},dataType:"json",beforeSend:function(){$.mobile.loading("show")},complete:function(a){$.mobile.loading("hide")},success:function(a){"ok"==a.result?a.response?($("#ubicacion-seleccion-ciudad").val(a.response.ciudad),$("#ubicacion-seleccion-sector").val(a.response.sector),$("#ubicacion-seleccion-direccion").val(""),ubicacionSeleccion()):a.responseHTML?($("#ubicacion-barrios-respuesta").html(a.responseHTML),$("#ubicacion-barrios-respuesta").trigger("create")):($.mobile.loading("hide"),alert("Respuesta incorrecta")):($.mobile.loading("hide"),alert(a.response))},error:function(a,b,c){$.mobile.loading("hide"),alert("Error: "+c)}}),!1}),$(document).on("click",'a[data-role="ubicacion-barriosOpciones"], li[data-role="ubicacion-barriosOpciones"]',function(){return $("#ubicacion-seleccion-ciudad").val($(this).attr("data-ciudad")),$("#ubicacion-seleccion-sector").val($(this).attr("data-sector")),$("#ubicacion-seleccion-direccion").val(""),ubicacionSeleccion(),!1}),$(document).on("change",'select[data-role="ciudad-despacho-map"]',function(){var a=$(this).val().trim();if(a.length>0){var b=$('select[data-role="ciudad-despacho-map"] option[value="'+a+'"]').attr("selected","selected");lat=parseFloat(b.attr("data-latitud")),lng=parseFloat(b.attr("data-longitud"))}}),$(document).on("click",'button[data-role="seleccionar-ciudad"]',function(){return $("#seleccion-ciudad").length>0?$.mobile.changePage("#seleccion-ciudad",{transition:"pop",role:"dialog",reverse:!1}):$.ajax({type:"POST",dataType:"html",async:!0,url:requestUrl+"/sitio/ciudades",beforeSend:function(){$.mobile.loading("show")},success:function(a){$("body").append(a),$.mobile.changePage("#seleccion-ciudad",{transition:"pop",reverse:!1,position:"window"}),$.mobile.loading("hide")},error:function(a,b,c){$.mobile.loading("hide"),alert("Error: "+c)}}),!1}),$(document).on("click",'a[data-role="confirmar-seleccion-ciudad"]',function(){return $("#page-ubicacion-map").length>0?($.mobile.changePage("#page-ubicacion-map",{transition:"pop",role:"dialog",reverse:!1}),map.setZoom(15),resizeMap()):$.ajax({type:"POST",dataType:"html",async:!0,url:requestUrl+"/sitio/mapa",beforeSend:function(){$.mobile.loading("show")},success:function(a){$.getScript("https://maps.googleapis.com/maps/api/js?client="+gmapKey).done(function(b,c){$.getScript(requestUrl+"/js/ubicacion.min.js").done(function(b,c){$("body").append(a),inicializarMapa(),$.mobile.changePage("#page-ubicacion-map",{transition:"pop",role:"dialog",reverse:!1}),map.setZoom(15),resizeMap(),$.mobile.loading("hide")}).fail(function(a,b,c){$.mobile.loading("hide"),alert("Error al inicializar mapa: "+c)})}).fail(function(a,b,c){$.mobile.loading("hide"),alert("Error al cargar mapa: "+c)})},error:function(a,b,c){$.mobile.loading("hide"),alert("Error: "+c)}}),!1}),$(document).on("click",'button[data-role="ubicacion-direccion"]',function(){return $.ajax({type:"GET",async:!0,url:requestUrl+"/usuario/direccionesUbicacion",dataType:"html",beforeSend:function(){$("div[id='page-direccionesubicacion']").remove(),$.mobile.loading("show")},complete:function(a){$.mobile.loading("hide")},success:function(a){$("body").append(a),$.mobile.changePage("#page-direccionesubicacion",{transition:"pop",role:"dialog",reverse:!1})},error:function(a,b,c){Loading.hide(),bootbox.alert("Error: "+c)}}),!1}),$(document).on("click",'button[data-role="ubicacion-seleccion-direccion"]',function(){$("#ubicacion-seleccion-ciudad").val(""),$("#ubicacion-seleccion-sector").val(""),$("#ubicacion-seleccion-direccion").val($(this).attr("data-direccion")),ubicacionSeleccion()}),$(document).on("click",'a[data-role="ubicacion-seleccion-nodomicilio"]',function(){$("#ubicacion-seleccion-ciudad").val($(this).attr("data-ciudad")),$("#ubicacion-seleccion-sector").val($(this).attr("data-sector")),$("#ubicacion-seleccion-direccion").val(""),ubicacionSeleccion()}),$(document).on("click","a[data-eliminar='1'], a[data-eliminar='2'], a[data-eliminar='3']",function(){var a=$(this).attr("data-position"),b=$(this).attr("data-eliminar");$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/carro/eliminar",data:{id:a,eliminar:b},beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){"ok"==a.result?($("#div-carro").html(a.carro),$("#div-carro").trigger("create"),$("#panel-carro-canasta").html(a.canasta),$("#panel-carro-canasta").trigger("create")):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+a.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})},error:function(a,b,c){alert("Error: "+c)}})}),$(document).on("click","a[data-role='carrovaciar']",function(){$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/carro/vaciar",beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){"ok"==a.result?($("#div-carro").html(a.carro),$("#div-carro").trigger("create"),$("#panel-carro-canasta").html(a.canasta),$("#panel-carro-canasta").trigger("create")):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+a.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})},error:function(a,b,c){alert("Error: "+c)}})}),$(document).on("pagecreate",function(a){$(function(){$(window).scroll(function(){$(this).scrollTop()>100?$("a.scroll-top").fadeIn():$("a.scroll-top").fadeOut()}),$("a.scroll-top").click(function(){return $("html, body").animate({scrollTop:0},600),!1})}),$("[data-role='raty']").raty({starOn:requestUrl+"/libs/raty/images/star-on.png",starOff:requestUrl+"/libs/raty/images/star-off.png",starHalf:requestUrl+"/libs/raty/images/star-half.png",cancelOn:requestUrl+"/libs/raty/images/cancel-on.png",cancelOff:requestUrl+"/libs/raty/images/cancel-off.png",hints:["mala","deficiente","regular","buena","excelente"],noRatedMsg:"Sin calificación",readOnly:function(){return"true"===$(this).attr("data-readonly")},click:function(a,b){if($(this).attr("data-callback")){var c=$(this).attr("data-callback");window[c](a,b)}},score:function(){return $(this).attr("data-score")}}),$("[id^='owl-productodetalle-']").owlCarousel({navigation:!1,slideSpeed:300,paginationSpeed:400,singleItem:!0,autoPlay:1e4}),$("[id^='slide-relacionados']").owlCarousel({slideSpeed:300,paginationSpeed:400,autoPlay:3e3,items:4,itemsDesktop:[1e3,5],itemsDesktopSmall:[900,3],itemsTablet:[600,2],itemsMobile:[300,2]}),$("[id^='slide-imagenes']").owlCarousel({autoPlay:3e3,items:2,itemsDesktop:[1199,3],itemsDesktopSmall:[979,3]}),pagoCredirebaja("#form-pago-pago","FormaPagoForm"),pagoCredirebaja("#form-pagoexpess","PagoExpress"),colapseDireccion(),$(function(){var a=$("textarea[data-countchar]");a.length&&countChar(a,a.attr("data-countchar"))}),$("div[id^='collapsible-direccion-ciudad-']").on("collapsiblecollapse",function(a,b){$("div[id^='div-direccion-form-']").css("display","none"),$("input[id^='DireccionesDespacho_idDireccionDespacho_']").removeAttr("checked"),$("input[id^='DireccionesDespacho_idDireccionDespacho_']").checkboxradio("refresh")})}),$(document).on("click","button[data-role='calificacion']",function(){var a=$(this).attr("data-producto"),b=$("#calificacion-titulo-"+a),c=$("#calificacion-comentario-"+a),d=$("#calificacion-raty-"+a).raty("score");return d=parseInt(d),isNaN(d)&&(d=0),$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/catalogo/calificar",data:{codigo:a.trim(),titulo:b.val().trim(),comentario:c.val().trim(),calificacion:d},beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(b){"ok"===b.result?($("[data-role='calificacion']").remove(),$("#calificacion-raty-"+a).raty("readOnly",!0),$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+b.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+b.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})},error:function(a,b,c){alert("Error: "+c)}}),!1}),$(document).on("change","input[id^='FiltroForm_listMarcas_']",function(){recalcularFiltros(1)}),$(document).on("change","input[id^='FiltroForm_listFiltros_']",function(){recalcularFiltros(2)}),$(document).on("click","a[data-cargar='1']",function(){var a=$(this).attr("data-producto"),b=$("#cantidad-producto-unidad-"+a).val();b=parseInt(b),isNaN(b)&&(b=-1);var c=parseInt($("#cantidad-producto-fraccion-"+a).val());c=parseInt(c),isNaN(c)&&(c=-1),$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/carro/agregar",data:{producto:a,cantidadU:b,cantidadF:c},beforeSend:function(){quitarRelacionado(),$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(b){"ok"===b.result?($("#panel-carro-canasta").html(b.response.canastaHTML),$("#panel-carro-canasta").trigger("create"),b.response.mensajeHTML&&(dialogoAnimado(b.response.mensajeHTML),$("#icono-producto-agregado-"+a).addClass("active")),b.response.dialogoHTML&&$("<div>").mdialog({content:b.response.dialogoHTML}),b.response.relacionados&&$("#link-relacionados-agregar").length>0&&($("#link-relacionados-agregar").attr("href",requestUrl+"/catalogo/relacionados/producto/"+a),animarRelacionado())):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+b.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})},error:function(a,b,c){alert("Error: "+c)}})}),$(document).on("click","a[data-cargar='2']",function(){var a=$(this).attr("data-combo"),b=$("#cantidad-combo-"+a).val();b=parseInt(b),isNaN(b)&&(b=0),$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/carro/agregarCombo",data:{combo:a,cantidad:b},beforeSend:function(){$.mobile.loading("show"),quitarRelacionado()},complete:function(){$.mobile.loading("hide")},success:function(b){"ok"===b.result?($("#panel-carro-canasta").html(b.response.canastaHTML),$("#panel-carro-canasta").trigger("create"),b.response.mensajeHTML&&(dialogoAnimado(b.response.mensajeHTML),$("#icono-combo-agregado-"+a).addClass("active")),b.response.dialogoHTML&&$("<div>").mdialog({content:b.response.dialogoHTML})):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+b.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})},error:function(a,b,c){alert("Error: "+c)}})}),$(document).on("click","a[data-cargar='3']",function(){var a=$(this).attr("data-producto"),b=$("#cantidad-producto-ubicacion-"+a).val();b=parseInt(b),isNaN(b)&&(b=0);var c=parseInt($("#cantidad-producto-bodega-"+a).val());c=parseInt(c),isNaN(c)&&(c=0),$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/carro/agregarBodega",data:{producto:a,cantidadU:b,cantidadB:c},beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){"ok"===a.result?($("#panel-carro-canasta").html(a.response.canastaHTML),$("#panel-carro-canasta").trigger("create"),a.response.mensajeHTML&&dialogoAnimado(a.response.mensajeHTML),a.response.dialogoHTML&&$("<div>").mdialog({content:a.response.dialogoHTML})):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+a.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})},error:function(a,b,c){alert("Error: "+c)}})}),$(document).on("change","input[data-modificar='1'], input[data-modificar='2'], input[data-modificar='3']",function(){var a=$(this).attr("data-position"),b=$(this).attr("data-modificar"),c={modificar:b,position:a};if(1==b){var d=parseInt($("#cantidad-producto-fraccion-"+a).val());isNaN(d)?d=-1:d<1&&(d=1);var e=parseInt($("#cantidad-producto-unidad-"+a).val());if((isNaN(e)||e<1)&&(e=1),d>0){var f=parseInt($(this).attr("data-nfracciones")),g=parseInt($(this).attr("data-ufraccionamiento")),h=Math.floor(f/g);if(d>=h){var i=Math.floor(d/h),j=d%h;e+=i,d=j}}c.cantidadU=e,c.cantidadF=d}else if(2==b){var k=parseInt($("#cantidad-producto-"+a).val());(isNaN(k)||k<1)&&(k=1),c.cantidad=k}else if(3==b){var k=parseInt($("#cantidad-producto-bodega-"+a).val());(isNaN(k)||k<1)&&(k=1),c.cantidad=k}$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/carro/modificar",data:c,beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){"ok"===a.result?($("#div-carro").html(a.response.carroHTML),$("#div-carro").trigger("create"),a.response.canastaHTML&&($("#panel-carro-canasta").html(a.response.canastaHTML),$("#panel-carro-canasta").trigger("create")),a.response.mensajeHTML&&dialogoAnimado(a.response.mensajeHTML),a.response.dialogoHTML&&$("<div>").mdialog({content:a.response.dialogoHTML})):($("#div-carro").html(a.response.carroHTML),$("#div-carro").trigger("create"),$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+a.response.message+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"}))},error:function(a,b,c){alert("Error: "+c)}})}),$(document).on("change",'input[name="DireccionesDespacho[idDireccionDespacho]"]:radio',function(a){var b=$('input[name="DireccionesDespacho[idDireccionDespacho]"]:checked').val();$("div[id^='div-direccion-form-']").css("display","none"),$("#div-direccion-form-"+b).css("display","block"),$("html,body").animate({scrollTop:$("#div-direccion-form-"+b).offset().top},200)}),$(document).on("click","input[id^='btn-direccion-actualizar-']",function(){var a=$(this).parents("form");return $.ajax({type:"POST",async:!0,url:requestUrl+"/usuario/direccionActualizar",data:a.serialize(),beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(b){var c=$.parseJSON(b);"ok"===c.result||("error"===c.result?alert(c.response):$.each(c,function(b,c){$("#"+a.attr("id")+" #"+b+"_em_").html(c),$("#"+a.attr("id")+" #"+b+"_em_").css("display","block")}))},error:function(a,b,c){alert("Error: "+c)}}),!1}),$(document).on("click","a[data-role='direccion-adicionar-modal']",function(){$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/usuario/direccionCrear",
