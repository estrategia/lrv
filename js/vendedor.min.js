function ubicacionGPSVendedor(){navigator.geolocation?($.mobile.loading("show"),navigator.geolocation.getCurrentPosition(obtenerPosicion,errorPosicion,{enableHighAccuracy:!0,timeout:3e4,maximumAge:0})):alert("Servicio no soportado por este navegador.")}function obtenerPosicion(a){var e=0,o=0;a&&(e=a.coords.latitude,o=a.coords.longitude),$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/vendedor/sitio/gps",data:{lat:e,lon:o},beforeSend:function(){$("#popup-ubicacion-gps").remove()},success:function(a){"ok"==a.result?$("<div>").mdialog({id:"popup-ubicacion-gps",content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+a.response.mensaje+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-role='ubicacion-gps-seleccion-vendedor' data-ciudad='"+a.response.ciudad+"' data-sector='"+a.response.sector+"' data-mensaje='"+a.response.mensaje+"' href='#'>Aceptar</a><a class='ui-btn ui-btn-n ui-corner-all ui-shadow btn-y' data-rel='back' href='#'>Cancelar</a></div></div>"}):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+a.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"}),$.mobile.loading("hide")},error:function(a,e,o){$.mobile.loading("hide"),alert("Error: "+o)}})}function errorPosicion(a){$.mobile.loading("hide");var e="NA";switch(a.code){case a.PERMISSION_DENIED:e="Por favor activar/habilitar servicio de ubicación de tu dispositivo.";break;case a.POSITION_UNAVAILABLE:e="Posición no disponible.";break;case a.TIMEOUT:e="Expiró el tiempo de espera.";break;case a.UNKNOWN_ERROR:e="Error desconocido: "+erro.message}alert(e)}function ubicacionSeleccion(a,e,o){$.ajax({type:"POST",async:!0,url:requestUrl+"/vendedor/sitio/ubicacionSeleccion",data:{ciudad:a,sector:e,direccion:o},dataType:"json",beforeSend:function(){$.mobile.loading("show")},complete:function(a){$.mobile.loading("hide")},success:function(a){"ok"==a.result?(dialogoAnimado(a.response),a.urlAnterior?location.href=a.urlAnterior:location.href=requestUrl+"/vendedor/"):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+a.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})},error:function(a,e,o){$.mobile.loading("hide"),alert(o)}})}function verUbicacionVendedor(){"0"==$("#ubicacion-info").attr("data-active")?($("#ubicacion-info").removeClass("hide"),$("#ubicacion-info").addClass("display"),$("#ubicacion-info").attr("data-active","1")):($("#ubicacion-info").removeClass("display"),$("#ubicacion-info").addClass("hide"),$("#ubicacion-info").attr("data-active","0"))}function animarRelacionado(){$("html, body").animate({scrollTop:0},600),$("#link-relacionados-agregar").css("opacity",""),intervalRelacionados=setInterval(function(){$("#link-relacionados-agregar").animate({opacity:"0.5"},400,function(){$("#link-relacionados-agregar").animate({opacity:"1"},400)})},1e3),$("#link-relacionados-agregar").css("display",""),setTimeout(function(){null!=intervalRelacionados&&(clearInterval(intervalRelacionados),intervalRelacionados=null),$("#link-relacionados-agregar").css("opacity","")},1e4)}function quitarRelacionado(){null!=intervalRelacionados&&(clearInterval(intervalRelacionados),intervalRelacionados=null),$("#link-relacionados-agregar").css("display","none"),$("#link-relacionados-agregar").css("opacity",""),$("#link-relacionados-agregar").attr("href","#")}function pasoTipoEntrega(a,e,o){var n={siguiente:e,"FormaPagoVendedorForm[indicePuntoVenta]":$('input[name="FormaPagoVendedorForm[indicePuntoVenta]"]').val(),"FormaPagoVendedorForm[tipoEntrega]":$('input[name="FormaPagoVendedorForm[tipoEntrega]"]').val()};$.ajax({type:"POST",async:!0,url:requestUrl+"/vendedor/carro/pagar/paso/"+a+"/post/true",data:$.param(n),beforeSend:function(){o.button("disable"),$('div[id^="FormaPagoVendedorForm_"].has-error').html(""),$('div[id^="FormaPagoVendedorForm_"].has-error').css("display","none"),$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){var e=$.parseJSON(a);"ok"===e.result?window.location.replace(e.redirect):"error"===e.result?(alerta(e.response),o.button("enable")):($.each(e,function(a,e){$("#"+a+"_em_").html(e),$("#"+a+"_em_").css("display","block")}),o.button("enable"))},error:function(a,e,n){alert("Error: "+n),o.button("enable")}})}function pasoDespacho(a,e,o){var n={siguiente:e,direccion:$('input[name="FormaPagoVendedorForm[idDireccionDespacho]"]:checked').val()};$.ajax({type:"POST",async:!0,url:requestUrl+"/vendedor/carro/pagar/paso/"+a+"/post/true",data:$.param(n)+"&"+$("#form-direccion-pagoinvitado").serialize(),beforeSend:function(){o.button("disable"),$('div[id^="FormaPagoVendedorForm_"].has-error').html(""),$('div[id^="FormaPagoVendedorForm_"].has-error').css("display","none"),$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){var e=$.parseJSON(a);"ok"===e.result?window.location.replace(e.redirect):"error"===e.result?(alerta(e.response),o.button("enable")):($.each(e,function(a,e){$("#"+a+"_em_").html(e),$("#"+a+"_em_").css("display","block")}),o.button("enable"))},error:function(a,e,n){alert("Error: "+n),o.button("enable")}})}function pasoEntrega(a,e,o){var n={siguiente:e};$.ajax({type:"POST",async:!0,url:requestUrl+"/vendedor/carro/pagar/paso/"+a+"/post/true",data:$.param(n)+"&"+$("#form-pago-entrega").serialize(),beforeSend:function(){o.button("disable"),$('div[id^="FormaPagoVendedorForm_"].has-error').html(""),$('div[id^="FormaPagoVendedorForm_"].has-error').css("display","none"),$("#form-pago-entrega").trigger("create"),$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){var e=$.parseJSON(a);"ok"===e.result?window.location.replace(e.redirect):"error"===e.result?(alerta(e.response),o.button("enable")):($.each(e,function(a,e){$("#"+a+"_em_").html(e),$("#"+a+"_em_").css("display","block")}),o.button("enable"))},error:function(a,e,n){alert("Error: "+n),o.button("enable")}})}function pasoPago(a,e,o){var n={siguiente:e};$.ajax({type:"POST",async:!0,url:requestUrl+"/vendedor/carro/pagar/paso/"+a+"/post/true",data:$.param(n)+"&"+$("#form-pago-pago").serialize(),beforeSend:function(){o.button("disable"),$('div[id^="FormaPagoVendedorForm_"].has-error').html(""),$('div[id^="FormaPagoVendedorForm_"].has-error').css("display","none"),$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){var e=$.parseJSON(a);"ok"===e.result?window.location.replace(e.redirect):"error"===e.result?(alerta(e.response),o.button("enable")):($.each(e,function(a,e){$("#"+a+"_em_").html(e),$("#"+a+"_em_").css("display","block")}),o.button("enable"))},error:function(a,e,n){alert("Error: "+n),o.button("enable")}})}function pasoConfirmacion(a,e,o){var n={siguiente:e};$.ajax({type:"POST",async:!0,url:requestUrl+"/vendedor/carro/pagar/paso/"+a+"/post/true",data:$.param(n)+"&"+$("#form-pago-confirmacion").serialize(),beforeSend:function(){o.button("disable"),$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){var e=$.parseJSON(a);"ok"===e.result?window.location.replace(e.redirect):"error"===e.result?(alerta(e.response),o.button("enable")):($.each(e,function(a,e){$("#"+a+"_em_").html(e),$("#"+a+"_em_").css("display","block")}),o.button("enable"))},error:function(a,e,n){alert("Error: "+n),o.button("enable")}})}function subtotalUnidadProducto(a){var e=$("#cantidad-producto-unidad-"+a).val();e=parseInt(e),isNaN(e)&&(e=1),1>=e&&(e=1),$("#cantidad-producto-unidad-"+a).val(e),$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/catalogo/subtotalUnidad",data:{codigo:a,cantidad:e},beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(e){"ok"==e.result?$("#subtotal-producto-unidad-"+a).html(e.response.valorFormato):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+e.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})},error:function(a,e,o){alert("Error: "+o)}})}function subtotalParcialProductoFraccion(a,e,o){var n=parseInt($("#cantidad-producto-fraccion-"+a).val());isNaN(n)&&(n=0),0>n&&(n=0),$("#cantidad-producto-fraccion-"+a).val(n);var i=Math.floor(e/o),r=$("#cantidad-producto-unidad-"+a).val();if(r=parseInt(r),isNaN(r)&&(r=0),0>r&&(r=0),n>=i){var t=Math.floor(n/i),c=n%i;r+=t,n=c}$("#cantidad-producto-unidad-"+a).val(r),$("#cantidad-producto-fraccion-"+a).val(n),$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/catalogo/subtotalFraccion",data:{codigo:a,cantidadUnidad:r,cantidadFraccion:n},beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(e){"ok"==e.result?($("#subtotal-producto-unidad-"+a).html(e.response.valorUnidadFormato),$("#subtotal-producto-fraccion-"+a).html(e.response.valorFraccionFormato),$("#total-producto-"+a).html(e.response.valorTotalFormato)):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+e.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})},error:function(a,e,o){alert("Error: "+o)}})}function subtotalProductoBodega(a){var e=parseInt($("#cantidad-producto-ubicacion-"+a).val());isNaN(e)&&(e=0),0>e&&(e=0);var o=$("#cantidad-producto-bodega-"+a).val();o=parseInt(o),isNaN(o)&&(o=0),0>o&&(o=0),$("#cantidad-producto-ubicacion-"+a).val(e),$("#cantidad-producto-bodega-"+a).val(o),$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/catalogo/subtotalBodega",data:{codigo:a,bodega:o,ubicacion:e},beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(e){"ok"==e.result?($("#subtotal-producto-bodega-"+a).html(e.response.valorBodegaFormato),$("#subtotal-producto-ubicacion-"+a).html(e.response.valorUbicacionFormato),$("#total-producto-"+a).html(e.response.valorTotalFormato)):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+e.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})},error:function(a,e,o){alert("Error: "+o)}})}function subtotalCombo(a){var e=$("#cantidad-combo-"+a).val();e=parseInt(e),isNaN(e)&&(e=1),1>=e&&(e=1),$("#cantidad-combo-"+a).val(e),$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/catalogo/subtotalCombo",data:{codigo:a,cantidad:e},beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(e){"ok"==e.result?$("#subtotal-combo-"+a).html(e.response.valorFormato):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+e.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})},error:function(a,e,o){alert("Error: "+o)}})}function subtotalProductoCarro(a){var e=$("#cantidad-producto-"+a).val();e=parseInt(e),isNaN(e)&&(e=1),1>=e&&(e=1),$("#cantidad-producto-"+a).val(e),$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/carro/modificar",data:{id:a,cantidad:e},beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){"ok"==a.result?($("#div-carro").html(a.carro),$("#div-carro").trigger("create"),$("#panel-carro-canasta").html(a.canasta),$("#panel-carro-canasta").trigger("create")):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+a.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})},error:function(a,e,o){alert("Error: "+o)}})}function seleccionTipoEntrega(a,e){$('div[data-role="tipoentrega"]').removeClass("activo"),$('div[data-role="tipoentrega"]div[data-tipo="'+a+'"]').addClass("activo"),$('div[data-role="tipoentrega"]').addClass("inactivo"),$('div[data-role="tipoentrega"]div[data-tipo="'+a+'"]').removeClass("inactivo"),$("#FormaPagoVendedorForm_tipoEntrega").val(a),$('input[name="FormaPagoVendedorForm[indicePuntoVenta]"]').val("")}$(document).on("click","#form-autenticar input[data-vendedor='autenticar']",function(){var a=$(this).parents("form"),e=$(this);return $.ajax({type:"POST",async:!0,url:requestUrl+"/vendedor/usuario/ingresar",data:a.serialize(),beforeSend:function(){e.button("disable"),$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(o){var n=$.parseJSON(o);"ok"===n.result?window.location.replace(n.response.redirect):"error"===n.result?(e.button("enable"),$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+n.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})):(e.button("enable"),$.each(n,function(e,o){$("#"+a.attr("id")+" #"+e+"_em_").html(o),$("#"+a.attr("id")+" #"+e+"_em_").css("display","block")}))},error:function(a,o,n){e.button("enable"),alert("Error: "+n)}}),!1}),$(document).on("click","input[data-role='buscar-cliente']",function(){var a=$(this).parents("form"),e=$(this);return $.ajax({type:"POST",async:!0,url:requestUrl+"/vendedor/cliente/buscarCliente",data:a.serialize(),beforeSend:function(){e.button("disable"),$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(o){var n=$.parseJSON(o);"ok"===n.result?($("#identificacionCliente").val(n.response.identificacion),$("#informacionCliente").html("<div data-role='main'><div class='ui-content' data-role='content' role='main'>Identificación cliente: <strong>"+n.response.identificacion+"</strong><br/>Nombre cliente: <strong>"+n.response.nombre+" "+n.response.apellido+"</strong><a href='#' class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-role='autenticar-cliente' >Aceptar</a></div></div>"),e.button("enable")):"error"===n.result?(e.button("enable"),$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+n.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})):(e.button("enable"),$.each(n,function(e,o){$("#"+a.attr("id")+" #"+e+"_em_").html(o),$("#"+a.attr("id")+" #"+e+"_em_").css("display","block")}))},error:function(a,o,n){e.button("enable"),alert("Error: "+n)}}),!1}),$(document).on("click","input[data-role='cliente-invitado']",function(){var a=$(this);return $.ajax({type:"POST",async:!0,url:requestUrl+"/vendedor/cliente/invitado",beforeSend:function(){a.button("disable"),$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){var e=$.parseJSON(a);"ok"===e.result?window.location.replace(e.urlRefer):"error"===e.result?$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+e.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"}):$.each(e,function(a,e){$("#"+form.attr("id")+" #"+a+"_em_").html(e),$("#"+form.attr("id")+" #"+a+"_em_").css("display","block")})},error:function(e,o,n){a.button("enable"),alert("Error: "+n)}}),!1}),$(document).on("click","a[data-role='autenticar-cliente']",function(){var a=$(this),e=$("#Usuario_identificacionUsuario").val();return $.ajax({type:"POST",async:!0,url:requestUrl+"/vendedor/cliente/autenticarCliente",data:{identificacion:e},beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){var e=$.parseJSON(a);"ok"===e.result?window.location.replace(e.urlRefer):"error"===e.result?$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+e.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"}):$.each(e,function(a,e){$("#"+form.attr("id")+" #"+a+"_em_").html(e),$("#"+form.attr("id")+" #"+a+"_em_").css("display","block")})},error:function(e,o,n){a.button("enable"),alert("Error: "+n)}}),!1}),$(document).on("click","#form-recordar input[data-vendedor='recordar']",function(){var a=$(this).parents("form"),e=$(this);return $.ajax({type:"POST",async:!0,url:requestUrl+"/vendedor/usuario/recordar",data:a.serialize(),beforeSend:function(){e.button("disable"),$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(o){var n=$.parseJSON(o);"ok"===n.result?(e.button("enable"),a.trigger("reset"),$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+n.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})):"error"===n.result?(e.button("enable"),$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+n.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})):(e.button("enable"),$.each(n,function(e,o){$("#"+a.attr("id")+" #"+e+"_em_").html(o),$("#"+a.attr("id")+" #"+e+"_em_").css("display","block")}))},error:function(a,o,n){e.button("enable"),alert("Error: "+n)}}),!1}),$(document).on("click","a[data-role='cambioubicacionvendedor']",function(){$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/vendedor/carro/vacio",data:$("#form-listaguardar").serialize(),beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){"ok"==a.result?a.response?window.location.replace(requestUrl+"/vendedor/sitio/ubicacion"):$("#popup-cambioubicacion").popup("open"):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+a.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})},error:function(a,e,o){$.mobile.loading("hide"),alert("Error: "+o)}})}),$(document).on("click",'a[data-role="ubicacion-gps-seleccion-vendedor"]',function(){var a=$(this).attr("data-ciudad"),e=$(this).attr("data-sector");$("#ubicacion-seleccion-direccion").val(""),ubicacionSeleccion(a,e,"")}),$(document).on("click",'button[data-role="ubicacion-direccion-cliente"]',function(){return $.ajax({type:"GET",async:!0,url:requestUrl+"/vendedor/cliente/direccionesUbicacion",dataType:"html",beforeSend:function(){$("div[id='page-direccionesubicacion']").remove(),$.mobile.loading("show")},complete:function(a){$.mobile.loading("hide")},success:function(a){$("body").append(a),$.mobile.changePage("#page-direccionesubicacion",{transition:"pop",role:"dialog",reverse:!1})},error:function(a,e,o){Loading.hide(),bootbox.alert("Error: "+o)}}),!1}),$(document).on("click",'button[data-role="ubicacion-seleccion-direccion-cliente"]',function(){var a=$(this).attr("data-direccion");$("#div-ubicacion-tipoubicacion > button").removeClass("activo").addClass("inactivo"),$('#div-ubicacion-tipoubicacion > button[data-role="ubicacion-direccion"]').removeClass("inactivo").addClass("activo"),ubicacionSeleccion("","",a)}),$(document).on("click",'a[data-role="ubicacion-seleccion-nodomicilio"]',function(){ubicacionSeleccion($(this).attr("data-ciudad"),$(this).attr("data-sector"),"")}),$(document).on("pagecreate",function(a){$("div[id^='collapsible-direccion-ciudad-']").on("collapsiblecollapse",function(a,e){$("div[id^='div-direccion-form-']").css("display","none"),$("input[id^='DireccionesDespacho_idDireccionDespacho_']").removeAttr("checked"),$("input[id^='DireccionesDespacho_idDireccionDespacho_']").checkboxradio("refresh")}),$("[id^='owl-productodetalle-']").owlCarousel({navigation:!1,slideSpeed:300,paginationSpeed:400,singleItem:!0,autoPlay:1e4}),$("[id^='slide-relacionados']").owlCarousel({slideSpeed:300,paginationSpeed:400,autoPlay:3e3,items:4,itemsDesktop:[1e3,5],itemsDesktopSmall:[900,3],itemsTablet:[600,2],itemsMobile:[300,2]})}),$(document).on("change",'input[name="DireccionesDespacho[idDireccionDespacho]"]:radio',function(a){var e=$('input[name="DireccionesDespacho[idDireccionDespacho]"]:checked').val();$("div[id^='div-direccion-form-']").css("display","none"),$("#div-direccion-form-"+e).css("display","block"),$("html,body").animate({scrollTop:$("#div-direccion-form-"+e).offset().top},200)}),$(document).ready(function(){$(".lst_ub_cdd .ui-collapsible-heading-toggle").click(function(){$("li a.c_btn_sel").removeClass("ui-btn-active2"),$(".list_ciud.ui-listview li").removeClass("active2")}),$("a.c_btn_sel").click(function(){$("li a.c_btn_sel").removeClass("ui-btn-active2"),$(".list_ciud.ui-listview li").removeClass("active2"),$(this).addClass("ui-btn-active2"),$(this).parent("li").addClass("active2")})}),$(document).on("click",'button[data-role="ubicacion-mapa"]',function(){return $("#page-ubicacion-map").length>0?($.mobile.changePage("#page-ubicacion-map",{transition:"pop",role:"dialog",reverse:!1}),resizeMap()):$.ajax({type:"POST",dataType:"html",async:!0,url:requestUrl+"/vendedor/sitio/mapa",beforeSend:function(){$.mobile.loading("show")},success:function(a){$.getScript("https://maps.googleapis.com/maps/api/js?client="+gmapKey).done(function(e,o){$.getScript(requestUrl+"/js/ubicacion.min.js").done(function(e,o){$("body").append(a),inicializarMapa(),$.mobile.changePage("#page-ubicacion-map",{transition:"pop",role:"dialog",reverse:!1}),resizeMap(),$.mobile.loading("hide")}).fail(function(a,e,o){$.mobile.loading("hide"),alert("Error al inicializar mapa: "+o)})}).fail(function(a,e,o){$.mobile.loading("hide"),alert("Error al cargar mapa: "+o)})},error:function(a,e,o){$.mobile.loading("hide"),alert("Error: "+o)}}),!1}),$(document).on("change",'select[data-role="ciudad-despacho-map"]',function(){var a=$(this).val().trim();if(a.length>0){var e=$('select[data-role="ciudad-despacho-map"] option[value="'+a+'"]').attr("selected","selected");map&&(map.setCenter(new google.maps.LatLng(parseFloat(e.attr("data-latitud")),parseFloat(e.attr("data-longitud")))),map.setZoom(13),$("#select-ubicacion-preferencia").remove(),$("#select-ubicacion-psubsector").removeClass("div-center").addClass("float-left"),$.ajax({type:"POST",async:!0,url:requestUrl+"/vendedor/sitio/ubicacionSeleccion",data:{ciudad:a},dataType:"html",beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){a.length>0?($("#select-ubicacion-content").append(a),$("#select-ubicacion-content").trigger("create")):$("#select-ubicacion-psubsector").removeClass("float-left").addClass("div-center")},error:function(a,e,o){$.mobile.loading("hide"),alert("Error: "+o)}}))}}),$(document).on("change",'select[data-role="sector-despacho-map"]',function(){var a=$(this).val().trim();if(a.length>0){var e=$('select[data-role="sector-despacho-map"] option[value="'+a+'"]').attr("selected","selected");map&&(map.setCenter(new google.maps.LatLng(parseFloat(e.attr("data-latitud")),parseFloat(e.attr("data-longitud")))),map.setZoom(14))}}),$(document).on("click",'a[data-role="ubicacion-seleccion-mapa"]',function(){var a=0,e=0;map&&(a=map.getCenter().lat(),e=map.getCenter().lng()),$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/vendedor/sitio/gps",data:{lat:a,lon:e},beforeSend:function(){$.mobile.loading("show")},success:function(a){"ok"==a.result?ubicacionSeleccion(a.response.ciudad,a.response.sector,""):a.responseModal?$("<div>").mdialog({content:a.responseModal}):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+a.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"}),$.mobile.loading("hide")},error:function(a,e,o){$.mobile.loading("hide"),alert(o)}})}),$(document).on("click","input[data-role='direccion-adicionar']",function(){var a=$(this).parents("form"),e=$(this).attr("data-modal"),o={modal:e};return $.ajax({type:"POST",async:!0,url:requestUrl+"/vendedor/cliente/direccionCrear",data:$.param(o)+"&"+a.serialize(),beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(o){var o=$.parseJSON(o);"ok"===o.result?1==e?($("#div-direcciones-lista").html(o.response.direccionesHTML),$("#div-direcciones-lista").trigger("create"),$("div[id^='page-direccion-crear-']").dialog("close"),dialogoAnimado(o.response.mensaje)):location.reload():"error"===o.result?$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+o.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"}):$.each(o,function(e,o){$("#"+a.attr("id")+" #"+e+"_em_").html(o),$("#"+a.attr("id")+" #"+e+"_em_").css("display","block")})},error:function(a,e,o){alert("Error: "+o)}}),!1}),$(document).on("click","a[data-role='direccion-adicionar-modal']",function(){$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/vendedor/cliente/direccionCrear",data:{render:!0},beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){var e="page-direccion-crear-"+uniqueId(),o="<div data-role='page' id='"+e+"'><div data-role='main' class='ui-content'>"+a.response.dialogoHTML+"<a href='#' class='ui-btn ui-btn-n ui-corner-all ui-shadow' data-rel='back'>Cerrar</a></div></div>";$("body").append(o),$.mobile.changePage("#"+e,{transition:"pop",role:"dialog",reverse:!1})},error:function(a,e,o){$.mobile.loading("hide"),alert("Error: "+o)}})}),intervalRelacionados=null,$(document).on("click","a[data-cargar='1']",function(){var a=$(this).attr("data-producto"),e=$("#cantidad-producto-unidad-"+a).val();e=parseInt(e),isNaN(e)&&(e=-1);var o=parseInt($("#cantidad-producto-fraccion-"+a).val());o=parseInt(o),isNaN(o)&&(o=-1),$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/vendedor/carro/agregar",data:{producto:a,cantidadU:e,cantidadF:o},beforeSend:function(){quitarRelacionado(),$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(e){"ok"===e.result?($("#panel-carro-canasta").html(e.response.canastaHTML),$("#panel-carro-canasta").trigger("create"),e.response.mensajeHTML&&(dialogoAnimado(e.response.mensajeHTML),$("#icono-producto-agregado-"+a).addClass("active")),e.response.dialogoHTML&&$("<div>").mdialog({content:e.response.dialogoHTML}),e.response.relacionados&&$("#link-relacionados-agregar").length>0&&($("#link-relacionados-agregar").attr("href",requestUrl+"/vendedor/catalogo/relacionados/producto/"+a),animarRelacionado())):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+e.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})},error:function(a,e,o){alert("Error: "+o)}})}),$(document).on("click","a[data-cargar='2']",function(){var a=$(this).attr("data-combo"),e=$("#cantidad-combo-"+a).val();e=parseInt(e),isNaN(e)&&(e=0),$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/vendedor/carro/agregarCombo",data:{combo:a,cantidad:e},beforeSend:function(){$.mobile.loading("show"),quitarRelacionado()},complete:function(){$.mobile.loading("hide")},success:function(e){"ok"===e.result?($("#panel-carro-canasta").html(e.response.canastaHTML),$("#panel-carro-canasta").trigger("create"),e.response.mensajeHTML&&(dialogoAnimado(e.response.mensajeHTML),$("#icono-combo-agregado-"+a).addClass("active")),e.response.dialogoHTML&&$("<div>").mdialog({content:e.response.dialogoHTML})):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+e.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})},error:function(a,e,o){alert("Error: "+o)}})}),$(document).on("click","a[data-cargar='3']",function(){var a=$(this).attr("data-producto"),e=$("#cantidad-producto-ubicacion-"+a).val();e=parseInt(e),isNaN(e)&&(e=0);var o=parseInt($("#cantidad-producto-bodega-"+a).val());o=parseInt(o),isNaN(o)&&(o=0),$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/vendedor/carro/agregarBodega",data:{producto:a,cantidadU:e,cantidadB:o},beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){"ok"===a.result?($("#panel-carro-canasta").html(a.response.canastaHTML),$("#panel-carro-canasta").trigger("create"),a.response.mensajeHTML&&dialogoAnimado(a.response.mensajeHTML),a.response.dialogoHTML&&$("<div>").mdialog({content:a.response.dialogoHTML})):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+a.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})},error:function(a,e,o){alert("Error: "+o)}})}),$(document).on("click","a[data-role='carrovaciar']",function(){$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/vendedor/carro/vaciar",beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){"ok"==a.result?($("#div-carro").html(a.carro),$("#div-carro").trigger("create"),$("#panel-carro-canasta").html(a.canasta),$("#panel-carro-canasta").trigger("create")):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+a.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})},error:function(a,e,o){alert("Error: "+o)}})}),$(document).on("click","input[id='btn-carropagar-siguiente'], input[id='btn-carropagar-anterior']",function(){var a=$(this).attr("data-origin"),e=$(this).attr("data-redirect");return"tipoentrega"==a?pasoTipoEntrega(a,e,$(this)):"despacho"===a?pasoDespacho(a,e,$(this)):"entrega"===a?pasoEntrega(a,e,$(this)):"pago"===a?pasoPago(a,e,$(this)):"confirmacion"===a&&pasoConfirmacion(a,e,$(this)),!1}),$(document).on("click","a[data-role='listapersonal']",function(){var a=$(this).attr("data-lista");$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/vendedor/carro/agregarlista",data:{lista:a},beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){"ok"===a.result?($("#panel-carro-canasta").html(a.response.canastaHTML),$("#panel-carro-canasta").trigger("create"),a.response.mensajeHTML&&dialogoAnimado(a.response.mensajeHTML),a.response.dialogoHTML&&$("<div>").mdialog({content:a.response.dialogoHTML})):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+a.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})},error:function(a,e,o){$.mobile.loading("hide"),alert("Error: "+o)}})}),$(document).on("click","a[data-role='pedidodetalle']",function(){var a=$(this).attr("data-compra");$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/vendedor/carro/agregarcompra",data:{compra:a},beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){"ok"===a.result?($("#panel-carro-canasta").html(a.response.canastaHTML),$("#panel-carro-canasta").trigger("create"),a.response.mensajeHTML&&dialogoAnimado(a.response.mensajeHTML),a.response.dialogoHTML&&$("<div>").mdialog({content:a.response.dialogoHTML})):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+a.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})},error:function(a,e,o){$.mobile.loading("hide"),alert("Error: "+o)}})}),$(document).on("change","input[data-modificar='1'], input[data-modificar='2'], input[data-modificar='3']",function(){var a=$(this).attr("data-position"),e=$(this).attr("data-modificar"),o={
modificar:e,position:a};if(1==e){var n=parseInt($("#cantidad-producto-fraccion-"+a).val());isNaN(n)?n=-1:1>n&&(n=1);var i=parseInt($("#cantidad-producto-unidad-"+a).val());if((isNaN(i)||1>i)&&(i=1),n>0){var r=parseInt($(this).attr("data-nfracciones")),t=parseInt($(this).attr("data-ufraccionamiento")),c=Math.floor(r/t);if(n>=c){var d=Math.floor(n/c),l=n%c;i+=d,n=l}}o.cantidadU=i,o.cantidadF=n}else if(2==e){var s=parseInt($("#cantidad-producto-"+a).val());(isNaN(s)||1>s)&&(s=1),o.cantidad=s}else if(3==e){var s=parseInt($("#cantidad-producto-bodega-"+a).val());(isNaN(s)||1>s)&&(s=1),o.cantidad=s}$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/vendedor/carro/modificar",data:o,beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){"ok"===a.result?($("#div-carro").html(a.response.carroHTML),$("#div-carro").trigger("create"),a.response.canastaHTML&&($("#panel-carro-canasta").html(a.response.canastaHTML),$("#panel-carro-canasta").trigger("create")),a.response.mensajeHTML&&dialogoAnimado(a.response.mensajeHTML),a.response.dialogoHTML&&$("<div>").mdialog({content:a.response.dialogoHTML})):($("#div-carro").html(a.response.carroHTML),$("#div-carro").trigger("create"),$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+a.response.message+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"}))},error:function(a,e,o){alert("Error: "+o)}})}),$(document).on("click","a[data-eliminar='1'], a[data-eliminar='2'], a[data-eliminar='3']",function(){var a=$(this).attr("data-position"),e=$(this).attr("data-eliminar");$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/vendedor/carro/eliminar",data:{id:a,eliminar:e},beforeSend:function(){$.mobile.loading("show")},complete:function(){$.mobile.loading("hide")},success:function(a){"ok"==a.result?($("#div-carro").html(a.carro),$("#div-carro").trigger("create"),$("#panel-carro-canasta").html(a.canasta),$("#panel-carro-canasta").trigger("create")):$("<div>").mdialog({content:"<div data-role='main'><div class='ui-content' data-role='content' role='main'>"+a.response+"<a class='ui-btn ui-btn-r ui-corner-all ui-shadow' data-rel='back' href='#'>Aceptar</a></div></div>"})},error:function(a,e,o){alert("Error: "+o)}})}),$(document).on("click",'div[data-role="tipoentrega"], a[data-role="tipoentrega"]',function(){var a=$(this).attr("data-tipo"),e=a==tipoEntrega.presencial?tipoEntrega.domicilio:tipoEntrega.presencial;a==tipoEntrega.presencial?$.ajax({type:"POST",dataType:"json",async:!0,url:requestUrl+"/vendedor/carro/pasoporel",data:{opcion:"modal"},beforeSend:function(){$("#page-pasoporel").remove(),$.mobile.loading("show")},success:function(a){"ok"==a.result?($("body").append(a.response),$.mobile.changePage("#page-pasoporel",{transition:"pop",role:"dialog",reverse:!1})):alert(a.response),$.mobile.loading("hide")},error:function(a,e,o){$.mobile.loading("hide"),alert("Error: "+o)}}):seleccionTipoEntrega(a,e)}),$(document).on("click",'button[data-role="pasoporel-seleccion-pdv"]',function(){seleccionTipoEntrega(tipoEntrega.presencial,tipoEntrega.domicilio),$("#page-pasoporel").dialog("close"),$('input[name="FormaPagoVendedorForm[indicePuntoVenta]"]').val($(this).attr("data-idx"))}),$(document).on("click",'a[data-role="tipoentrega-info"]',function(){var a=$(this).attr("href");return a?($(a).panel("open"),!1):void 0});